
## 概要
- **移行元**: Nuxt.js + Directus (https://genetics.qlife.jp/)
- **移行先**: WordPress
- **GitHub**: https://github.com/QLife-Inc/genetics.qlife.jp

---
## Step1: 現状調査

#### やること

- __コンテンツの棚卸し__

	- ページ数や記事数、画像数の把握
		- 管理画面で確認 or SELECT文で各コレクション別にデータ数を取得（公開ステータス込み）
		- 最終更新日の範囲の確認（いつからいつまでのデータか）

	- 使用機能の洗い出し

- __Directus のDBの構造把握__
	- 各テーブルのフィールド情報を記録
		- コンフルにも一応記載はあるが、更新されていない可能性があるので実テーブルで確認

	- 主要コレクション
		- **遺伝性疾患解説** - 疾患に関する詳細解説記事
		- **遺伝性疾患 関連記事** - 関連する記事コンテンツ
		- **特集** - 特集企画のメタ情報
		- **特集記事** - 特集に含まれる個別記事
		- **用語集** - 医療用語の解説
		- **問い合わせ** - お問い合わせフォームデータ
		- **インタビュー対象者** - インタビュー記事の対象者情報
		- **限定公開記事** - 会員限定コンテンツ
		- **ニュース** - ニュース記事
		- **その他の記事** - 分類されていない記事
		- **専門家インタビュー** - 専門家へのインタビュー記事
		- **支援者** - サイト支援者情報
		- **タグ** - 記事分類用タグ
		- **学習** - 学習コンテンツのメタ情報
		- **学習記事** - 学習用記事

- __現在のサイトのURL構造を確認__

	- __実際のサイトでURL確認__

	  - 各種ページのURLをブラウザのアドレスバーで確認し記録

	- __URL パターンの分類__
	
	- __特殊なURL の確認__

	  - 日本語が含まれるURL
	  - 階層が深いURL
	  - パラメータが付くURL

	- __内部リンクの調査__

	  - 記事内で他の記事へのリンクがどのように設定されているか
	  - 相対パス・絶対パスの使い分け



## Step2: WordPressサイト設定
#### やること

- __wordpress.comでのサイト初期設定__

  - サイト名：「遺伝性疾患プラス」
  - ドメイン設定：
  - 基本設定（タイムゾーン、言語など）
  - SSL証明書・セキュリティ設定の確認


- __必要な機能の追加__

  - カスタム投稿タイプ機能
  - カスタムフィールド機能（疾患コード、英名などの詳細情報を管理）
  - パーマリンク設定

- __設定すべきカスタム投稿タイプ___
	- メインコンテンツ用
		- `disease` - 遺伝性疾患解説
		- `news` - ニュース
		- `interview` - 専門家インタビュー
		- `glossary` - 用語集（プラグイン使用）
	- 関連コンテンツ用
		- `disease_article` - 遺伝性疾患 関連記事
		- `other_article` - その他の記事
		- `feature` - 特集（親）
			- `feature_article` - 特集記事（子）
		- `tutorial` - 学習（親）
			- `tutorial_article` - 学習記事（子）
	- 特殊コンテンツ用
		- `limited_article` - 限定公開記事
		- `supporter` - 支援者
	- 必要な追加機能
		- 会員制機能 - 限定公開記事のアクセス制御
		- 階層構造管理 - 特集と特集記事、学習と学習記事の親子関係
		- 問い合わせフォーム - Contact Form 7などのプラグイン


## Step 3: データ移行

__主な移行手段__
- WordPress REST API
	- wordpress.com で OAuth認証 & API トークン取得
	- レートリミットの確認
	- 接続テスト
- WordPress の標準インポート
- Directus REST API
	- API トークン生成
	- レートリミットの確認
	- 接続テスト

__主な移行手順__
1. Directus からデータを取得
2. データクリーニング
3. Wordpress.com へ登録

 __実行前の確認__

1. __移行環境の準備完了確認__

   - WordPress.com Business プランの有効化
   - 必要なプラグインのインストール・設定完了
   - カスタム投稿タイプ・フィールドの設定完了
   - テーマの基本設定完了

2. __バックアップの取得__

   - Directusデータベースの完全バックアップ
   - 現在のサイトのファイル・画像バックアップ
   - WordPress.com初期状態のエクスポート

3. __移行ツールの最終テスト__

   - API接続の確認
   - 少量データでの移行テスト
   - エラーハンドリングの動作確認


__第1段階：基盤データ__

1. タグ（全コンテンツで使用されるため最初に移行）
2. 支援者（インタビュー記事で参照されるため）
3. インタビュー対象者（各記事で参照されるため）

__第2段階：メインコンテンツ__ 
4. 遺伝性疾患解説 
5. 用語集 
6. ニュース 
7. 専門家インタビュー

__第3段階：関連コンテンツ__ 
8. 遺伝性疾患 関連記事 
9. その他の記事 
10. 特集 → 特集記事（親子関係を維持） 
11. 学習 → 学習記事（親子関係を維持）

__第4段階：特殊コンテンツ__ 
12. 限定公開記事 
13. 問い合わせデータ（必要に応じて）

#### 関連付けの処理

__複雑な関連付けが必要なもの__

- __専門家インタビュー__ ↔ __支援者__
- __遺伝性疾患 関連記事__ ↔ __遺伝性疾患解説__
- __特集記事__ ↔ __特集__
- __学習記事__ ↔ __学習__
- __インタビュー対象者__ ↔ 各種記事


## Step 4: URL設定とリダイレクト

__階層構造のURL__

- `/features/{特集名}/{記事名}` - 特集記事
- `/tutorials/{学習名}/{記事名}` - 学習記事
- `/diseases/{疾患名}/{カテゴリ}/{記事名}` - 疾患関連記事

__特殊なURL__

- `/limited-release/{記事名}` - 限定公開記事
- `/supporters/{支援者名}` - 支援者ページ
- `/glossary/{用語名}` - 用語集



## Step 5: デザイン・機能のカスタマイズ

#### 追加で必要な機能

__コンテンツ表示機能__

- 特集記事の一覧表示
- 学習コースの進捗表示
- 関連記事の自動表示
- 支援者情報の表示

__検索・フィルタ機能__

- 疾患名での検索
- カテゴリでの絞り込み
- タグでの絞り込み
- 用語集の五十音検索

__会員機能__

- ユーザー登録・ログイン
- 限定記事へのアクセス制御
- 会員限定コンテンツの表示






---

